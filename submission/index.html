<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Upload a Photo</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Inter:wght@300;400;500&display=swap" rel="stylesheet"/>

<style>
:root {
  --peach: #e6a07c;
  --rose: #d16c7c;
  --cream: #f6ede6;
  --ink: #3a2e2a;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: "Inter", sans-serif;
  background: var(--cream);
  color: var(--ink);
}

.container {
  max-width: 720px;
  margin: auto;
  padding: 30px;
}

.card {
  position: relative;
  background: var(--cream);
  background-image: url("/assets/form-background.jpg");
  background-size: cover;
  background-position: center;
  border-radius: 18px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.12);
  padding: 10%;
  
  overflow: visible;

}

.card::before {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(247,239,232,0.25);
  z-index: 0;
}

.card > * {
  position: relative;
  z-index: 1;
}

/* ---------- Arch ---------- */
.arch {
  text-align: center;
  color: white;
  padding: 24px 0;
  border-radius: 80px;
  border: 8px solid rgb(238 198 179);
  background-image: url("/assets/form-background.jpg");
  background-size: 200%;
  background-position: center 60%;
}

.arch h1 {
  font-family: "Playfair Display", serif;
  font-size: 34px;
  margin: 10px 0;
}

.arch small {
  letter-spacing: 2px;
  font-size: 13px;
}

.divider {
  width: 60px;
  height: 2px;
  background: var(--peach);
  margin: 18px auto;
}

/* ---------- Upload Form ---------- */
form {
  display: grid;
  gap: 14px;
  margin-top: 24px;
}

input,
button {
  padding: 14px 16px;
  border-radius: 12px;
  border: 1px solid #ddd;
  font-size: 16px;
  font-family: inherit;
  background: rgba(255,255,255,0.95);
}
input[type="file"] {
  width: 100%;
  max-width: 100%;
  line-height: normal;
}
  
button {
  background: var(--rose);
  color: white;
  border: none;
  cursor: pointer;
  font-weight: 500;
}

button:hover {
  opacity: 0.9;
}

/* ---------- Overlays ---------- */
#loadingOverlay,
#successOverlay {
  position: absolute;
  inset: 0;
  background: rgba(246, 237, 230, 0.92);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.6s ease;
  z-index: 5;
  border-radius: 18px;
}

#loadingOverlay.show,
#successOverlay.show {
  opacity: 1;
  pointer-events: auto;
}

/* ---------- Loader ---------- */
.loader {
  width: 48px;
  height: 48px;
  border: 4px solid rgba(0,0,0,0.1);
  border-top-color: var(--rose);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 16px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* ---------- Success Card ---------- */
.success-inner {
  background: rgba(255,255,255,0.95);
  padding: 28px 32px;
  border-radius: 20px;
  text-align: center;
  color: var(--rose);
  box-shadow: 0 12px 30px rgba(0,0,0,0.15);
  transform: scale(0.8);
  transition: transform 0.6s ease;
}

#successOverlay.show .success-inner {
  transform: scale(1);
}

/* ---------- Floating Emoji ---------- */
.success-emoji {
  position: absolute;
  font-size: 28px;
  animation: floatUp 3s ease forwards;
  pointer-events: none;
}

@keyframes floatUp {
  from { transform: translateY(0) rotate(0deg); opacity: 1; }
  to { transform: translateY(-220px) rotate(360deg); opacity: 0; }
}


  
/* ---------- Mobile ---------- */
@media (max-width: 600px) {
  .container {
    padding: 10px;
  }

  .card {
    padding: 24px 16px;
    min-height: auto;
  }

  .arch h1 {
    font-size: 26px;
  }
}
</style>
</head>

<body>
<div class="container">

  <div class="card">

    <div class="arch">
      <small>SHARE A MEMORY FROM</small>
      <br><br>
      <small>UPLOAD A PHOTO</small>
    </div>

    <div class="divider"></div>

    <!-- âœ… ORIGINAL FORM â€“ UNCHANGED FUNCTIONALLY -->
    <form onsubmit="event.preventDefault(); upload();">
      <input type="file" id="photo" accept="image/*" />
      <input type="text" id="caption" placeholder="Add a caption (optional)" />
      <button type="submit">Upload Photo</button>
    </form>
<!-- Loading Overlay -->
<div id="loadingOverlay">
  <div class="loader"></div>
  <p>Uploading your photoâ€¦</p>
</div>

<!-- Success Overlay -->
<div id="successOverlay">
  <div class="success-inner">
    <h2>Thank you! ðŸ’–</h2>
    <p>Your photo was uploaded successfully.</p>
  </div>
</div>
  </div>
</div>

<script>
async function upload() {
  const file = document.getElementById("photo").files[0];
  if (!file) return alert("No file selected");

  const loading = document.getElementById("loadingOverlay");
  const success = document.getElementById("successOverlay");
  const form = document.querySelector("form");

  // Show loading overlay
  loading.classList.add("show");

  const reader = new FileReader();

  reader.onload = async () => {
    const base64 = reader.result.split(",")[1];

    const body = new URLSearchParams();
    body.append("image", base64);
    body.append("name", file.name);
    body.append("type", file.type);
    body.append("caption", document.getElementById("caption").value);

    try {
      await fetch(
        "https://script.google.com/macros/s/AKfycbzZOZ5OVt3-NztmTS-a9KqQUMn6DB6vkE2wGd6lxHnsgWOYNZ4BrrZh_GJvN0yXuJHi3Q/exec",
        { method: "POST", body }
      );

      // Fade out loading
      loading.classList.remove("show");

      // Hide form
      form.style.transition = "opacity 0.6s ease";
      form.style.opacity = 0;

      setTimeout(() => {
        form.style.display = "none";
        success.classList.add("show");

        // Floating emojis (same vibe as RSVP)
        for (let i = 0; i < 12; i++) {
          const emoji = document.createElement("div");
          emoji.textContent = ["ðŸ“¸","ðŸ’–","âœ¨","ðŸ¼"][Math.floor(Math.random() * 4)];
          emoji.className = "success-emoji";
          emoji.style.left = Math.random() * 100 + "%";
          emoji.style.top = "60%";
          success.appendChild(emoji);

          setTimeout(() => emoji.remove(), 3000);
        }
      }, 600);

    } catch (err) {
      loading.classList.remove("show");
      alert("Upload failed. Please try again.");
      console.error(err);
    }
  };

  reader.readAsDataURL(file);
}

</script>

</body>
</html>
