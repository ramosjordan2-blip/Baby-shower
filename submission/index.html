<html>
  <body>
<input type="file" id="photo" accept="image/*" />
<input type="text" id="caption" placeholder="Caption" />
<button onclick="upload()">Upload</button>

<script>
async function upload() {
  const file = document.getElementById("photo").files[0];
  if (!file) return alert("No file selected");

  const reader = new FileReader();
  reader.onload = async () => {
    const base64 = reader.result.split(",")[1];

    const res = await fetch(
      "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          image: base64,
          name: file.name,
          type: file.type,
          caption: document.getElementById("caption").value
        })
      }
    );

    alert(await res.text());
  };

  reader.readAsDataURL(file);
}
</script>

</body>
  </html>
