<form
  action="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec"
  method="POST"
  enctype="multipart/form-data"
  target="uploadFrame"
>
  <input type="file" name="photo" accept="image/*" required />
  <input type="text" name="caption" placeholder="Caption" />
  <button type="submit">Upload</button>
</form>

<iframe name="uploadFrame" style="display:none;"></iframe>


<script>
const UPLOAD_URL = "https://script.google.com/macros/s/AKfycby8tIqEmXkUv4zrvcGPHjdm0Ji9miKNk17aNb0KKDCPaP3Am35ntEV4ssBOtB_uplTRRA/exec";

document.getElementById("uploadForm").addEventListener("submit", async e => {
  e.preventDefault();

  const formData = new FormData(e.target);

  await fetch(UPLOAD_URL, {
    method: "POST",
    body: formData
  });

  alert("Uploaded!");
});
</script>
